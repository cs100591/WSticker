# Daily PA App ä¼˜åŒ–è®°å½•

**æ—¥æœŸ**: 2026-02-03
**æ‰§è¡Œè€…**: åº—å°äºŒ (OpenClaw)

---

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. FloatingChatbot.tsx - é¢œè‰²é€‰æ‹©å™¨ä¿®å¤
**é—®é¢˜**: "Choose Color" åŒºåŸŸæ˜¾ç¤º3ä¸ªç›¸åŒçš„é»„è‰²åœ†ç‚¹
**ä¿®å¤**: æ”¹ä¸ºæ˜¾ç¤º5ä¸ªä¸åŒé¢œè‰² ğŸŸ¡ğŸ”µğŸ©·ğŸŸ¢ğŸŸ£
**è¡Œå·**: ~1192-1206

### 2. Supabase Edge Function - å¤šè¡Œç¨‹è¯†åˆ«
**é—®é¢˜**: AI åªèƒ½è¯†åˆ«ä¸€ä¸ªè¡Œç¨‹ï¼ˆå¦‚"æ˜å¤©ä¸‰ç‚¹å’Œå…­ç‚¹å¼€ä¼š"åªåˆ›å»ºä¸€ä¸ªï¼‰
**ä¿®å¤**: 
- å‡çº§ system promptï¼Œæ”¯æŒè¿”å› `actions` æ•°ç»„
- æ·»åŠ è¯¦ç»†çš„æ—¶é—´è§£æç¤ºä¾‹
- æ·»åŠ å¤šä»»åŠ¡å¤„ç†ç¤ºä¾‹
**æ–‡ä»¶**: `/supabase/functions/api/index.ts`

### 3. FloatingChatbot.tsx - ç§»é™¤ç›´æ¥è°ƒ OpenAI
**é—®é¢˜**: ä»£ç å°è¯•ç›´æ¥è°ƒç”¨ OpenAI APIï¼Œä½† Key å·²å¤±æ•ˆ (401 é”™è¯¯)
**ä¿®å¤**: åˆ é™¤ç›´æ¥è°ƒ OpenAI çš„ä»£ç ï¼Œç»Ÿä¸€èµ° Supabase Edge Function
**è¡Œå·**: ~1055-1100

### 4. env.ts - å®‰å…¨ä¿®å¤
**é—®é¢˜**: OpenAI API Key è¢«ç¡¬ç¼–ç åœ¨ä»£ç é‡Œ
**ä¿®å¤**: æ”¹ä¸ºä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œç§»é™¤ç¡¬ç¼–ç å€¼
**æ–‡ä»¶**: `/src/config/env.ts`

### 5. .env - æ›´æ–° API URL
**ä¿®æ”¹**: `EXPO_PUBLIC_API_URL` æ”¹ä¸ºæŒ‡å‘ Supabase Edge Function
**å€¼**: `https://qmpuasmglrkbnsymgaah.supabase.co/functions/v1/api`

### 6. aiService.ts - é‡å†™æœåŠ¡å±‚
**ä¿®æ”¹**: å®Œå…¨é‡å†™ä¸º Supabase ç‰ˆæœ¬
- ä½¿ç”¨ Supabase auth è·å– token
- è°ƒç”¨ `/functions/v1/api?route=/chat` å’Œ `/transcribe`
- æ·»åŠ é”™è¯¯å¤„ç†

### 7. ChatScreen.tsx - æ¢å¤ AI è°ƒç”¨
**é—®é¢˜**: `sendMessage` å‡½æ•°è¢«æ”¹æˆ Mock é€»è¾‘
**ä¿®å¤**: æ¢å¤è°ƒç”¨çœŸæ­£çš„ `aiService.sendMessage()`

### 8. æ–°å¢å·¥å…·æ–‡ä»¶ chatHelpers.ts
**è·¯å¾„**: `/src/utils/chatHelpers.ts`
**å†…å®¹**: 
- æ—¥æœŸæ—¶é—´æ ¼å¼åŒ–å·¥å…·
- è¯­è¨€æ£€æµ‹
- å¸¸é‡å®šä¹‰ï¼ˆä¼˜å…ˆçº§ã€åˆ†ç±»ã€é¢œè‰²ç­‰ï¼‰
- å¯å¤ç”¨çš„ helper å‡½æ•°

### 9. ä¼˜åŒ–é”™è¯¯æç¤ºæ–‡æ¡ˆ
**ä¿®æ”¹**: ç§»é™¤"ç¦»çº¿æ¨¡å¼"è¯´æ³•ï¼Œæ”¹ä¸ºæ›´å‹å¥½çš„"AI æœåŠ¡æš‚æ—¶æ— æ³•è¿æ¥"
**æ–‡ä»¶**: `FloatingChatbot.tsx`

---

## ğŸ“Œ å¾…å®Œæˆï¼ˆéœ€è¦ç”¨æˆ·æ“ä½œï¼‰

### Supabase Edge Function éƒ¨ç½²
```bash
cd /Users/cssee/Dev/WSticker/daily-pa
npx supabase login
npx supabase link --project-ref qmpuasmglrkbnsymgaah
npx supabase functions deploy api --no-verify-jwt
```

---

## ğŸ’¡ å»ºè®®çš„åç»­ä¼˜åŒ–

1. **æ‹†åˆ† FloatingChatbot.tsx** (61KB å¤ªå¤§)
   - æå– action card æ¸²æŸ“é€»è¾‘åˆ°ç‹¬ç«‹ç»„ä»¶
   - æå– voice recording é€»è¾‘åˆ° custom hook
   - ä½¿ç”¨ chatHelpers.ts ä¸­çš„å·¥å…·å‡½æ•°

2. **æ·»åŠ  Haptic åé¦ˆ**
   - ç¡®è®¤/å–æ¶ˆæ“ä½œæ—¶æ·»åŠ è§¦è§‰åé¦ˆ

3. **æ·»åŠ å¿«æ·å›å¤å»ºè®®**
   - AI å›å¤åæ˜¾ç¤ºå‡ ä¸ªå¸¸ç”¨å¿«æ·æŒ‰é’®

4. **æ·»åŠ æ’¤é”€åŠŸèƒ½**
   - ç¡®è®¤åˆ›å»ºåå‡ ç§’å†…å¯æ’¤é”€

5. **è¯­éŸ³åé¦ˆéŸ³æ•ˆ**
   - æ“ä½œæˆåŠŸ/å¤±è´¥æ—¶æ’­æ”¾æç¤ºéŸ³

---

## ğŸ”§ æŠ€æœ¯å€ºåŠ¡

1. `languageStore.ts` æœ‰ 51KB - è€ƒè™‘æ‹†åˆ†ç¿»è¯‘æ–‡ä»¶
2. éƒ¨åˆ†ç»„ä»¶ç¼ºå°‘ TypeScript ç±»å‹å®šä¹‰
3. é”™è¯¯å¤„ç†å¯ä»¥æ›´ç»Ÿä¸€

---

*è®°å½•å®Œæ¯•ã€‚æŒæŸœçš„æ—©ä¸Šå¥½ï¼*
